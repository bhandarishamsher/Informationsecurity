*/
Name : Shamsher Singh Bhandari  
Roll no : 49(1022759) Course : Bsc(it) 6th Sem  
Subject :Information Security 
Lab assigment 5

*/
//Write a c program to implement encryption and decryption using affine cipher.
#include<stdio.h>	
#include <ctype.h>  //for islower isuper
#include<string.h>	//strlen()


int ainv(int a){
	 
        int a_inv = 0;
        int flag = 0;
  
        //Find a^-1 (the multiplicative inverse of a 
        //in the group of integers modulo m.) 
        for (int i = 0; i < 26; i++) 
        {
            flag = (a * i) % 26;
  
            // Check if (a*i)%26 == 1,
            // then i will be the multiplicative inverse of a
            if (flag == 1) 
            {
                a_inv = i;
            }
        }
	return a_inv;
}


int main(){
	
	
	 int key=20;
	 int a = 17;
  
	int ch=1;
	start:
	printf("enter choise \n1:encription \n2:decription\n3:EXIT\n");
	scanf("%d",&ch);
	fflush(stdin);//clean stream input buffer 
	
	 int var=65, VAR=97;
	 if(ch==3)	{return 0;}
	char plantxt[100];
	
	

	if(ch==1)
	{
		printf("enter plan txt for encryption\n");
		fgets(plantxt ,sizeof(plantxt),stdin);		
		for(int i = 0 ;i<strlen(plantxt) ;i++ )
		{
			if(isupper(plantxt[i]))
			{plantxt[i]=((a* (plantxt[i] -var) +key)%26) +65;   }
	
		
		
			else if(islower(plantxt[i]))
			{plantxt[i]=((a* (plantxt[i] -VAR) +key)%26) +97;   }

		
		
			else {  plantxt[i]= plantxt[i];}
		}
	printf("  cipher text is %s",plantxt);
	}
	
	
	
	if(ch==2)
	{
		printf("enter cipher txt for decryption \n");
		fgets(plantxt ,sizeof(plantxt),stdin);	
		for(int i = 0 ;i<strlen(plantxt) ;i++ )
		{
			if(isupper(plantxt[i]))
			{plantxt[i]=(char)(((ainv(a)* (plantxt[i] - var+26 - key))%26) +65);   }
	
		
		
			else if(islower(plantxt[i]))
			{plantxt[i]=(char)(((ainv(a)* (plantxt[i] -VAR+26 - key))%26)+97);   }

		
		
			else {  plantxt[i]= plantxt[i];}
		
		}
		printf("  deciphe txt  is %s",plantxt);
	}
	else goto start;

	goto start;
	return 0;
}

/*
//..................OUTPUT.............................//
enter choise
1:encription
2:decription
3:EXIT
1
enter plan txt for encryption
UBBAHK CAPJKX
  cipher text is WLLUJI CUPRIV
enter choise
1:encription
2:decription
3:EXIT
2
enter cipher txt for decryption
WLLUJI CUPRIV
  deciphe txt  is UBBAHK CAPJKX
enter choise
1:encription
2:decription
3:EXIT
*/
